<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Porous model example run â€¢ Porous</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Porous model example run">
<meta property="og:description" content="Porous">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Porous</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">Porous model example run</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="my-vignette_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="my-vignette_files/viz-1.8.2/viz.js"></script><link href="my-vignette_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="my-vignette_files/grViz-binding-1.0.9/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Porous model example run</h1>
            
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="intro">Intro<a class="anchor" aria-label="anchor" href="#intro"></a>
</h2>
<p>This poorly written vignette contains some working example of how to
run the model in its current state.<br>
The code is organized in a series of functions:</p>
<div class="grViz html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e4a48da43faa10c1d35f" style="width:672px;height:288px;"></div>
<script type="application/json" data-for="htmlwidget-e4a48da43faa10c1d35f">{"x":{"diagram":"digraph {\n\ngraph [layout = dot, rankdir = LR]\n# define the global styles of the nodes. We can override these in box if we wish\nnode [shape = rectangle, style = filled, fillcolor = Linen]\n\nDelta_z [label =  \"Delta_z function\", fillcolor = cornflowerblue]\nphi_mat [label = \"phi_mat function\", fillcolor = darkseagreen3]\nphi_mic [label = \"phi_mic function\", fillcolor = bisque2]\nf_text_mic_func [label = \"f_text_mic_func function\", fillcolor = mediumpurple1]\nPorous [label = \"Porous function\", fillcolor = darkorange]\npore_frac [label= \"pore_frac function\", fillcolor = goldenrod2]\nMsc [label= \"Msc function\", fillcolor = yellowgreen]\nf_som [label= \"f_som function\", fillcolor = hotpink]\ngamma_b [label= \"gamma_b function\", fillcolor = seagreen2]\nrun_Porous [label= \"run_Porous function\", fillcolor = peachpuff]\n\n# edge definitions with the node IDs\nDelta_z -> phi_mat -> pore_frac\nDelta_z -> phi_mic -> pore_frac\nf_text_mic_func -> phi_mic\npore_frac -> Porous\nPorous -> run_Porous\nMsc -> f_som -> run_Porous\nMsc -> gamma_b -> run_Porous\n\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="example-how-to-to-run-the-main-model-function-written-within-the-soilr-model-development-framework">Example: how to to run the main model function (written within the
SoilR model development framework)<a class="anchor" aria-label="anchor" href="#example-how-to-to-run-the-main-model-function-written-within-the-soilr-model-development-framework"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Porous</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SoilR</span><span class="op">)</span> <span class="co">#this should load automatically anyway since it is required by Porous</span></span>
<span><span class="co">#&gt; Loading required package: deSolve</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'SoilR'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:deSolve':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     euler</span></span></code></pre></div>
<p>First we create the model object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">modelObject</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Porous.html">Porous</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This creates a model with the default parameters. The parameter
values can also be specified by the user (when one value is not
specified the parameter will have default value), such as:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelObject</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/Porous.html">Porous</a></span><span class="op">(</span>ky<span class="op">=</span><span class="fl">0.8</span>, ko<span class="op">=</span><span class="fl">0.00605</span>,</span>
<span>                    kmix<span class="op">=</span><span class="fl">0.9</span>,</span>
<span>                    e<span class="op">=</span><span class="fl">0.13</span>,</span>
<span>                    Im<span class="op">=</span><span class="fl">1.1</span>, Ir<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>                    F_prot<span class="op">=</span><span class="fl">0.0</span>,</span>
<span>                    phi_mac<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                    phi_min<span class="op">=</span><span class="fl">1</span>,</span>
<span>                    clay<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                    Delta_z_min<span class="op">=</span><span class="fl">20</span>,</span>
<span>                    gamma_o<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p>Many values can be omitted, and the function will use the defaults.
In particular <code>f_text_mic</code>, if omitted, will be calculated
internally with a specific function, <code><a href="../reference/f_text_mic_func.html">f_text_mic_func()</a></code>.</p>
<p><code>SoilR</code> has an internal function designed to plot any
model (but fluxes do not always seem consistent in the
representation):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SoilR/man/plotPoolGraph.html" class="external-link">plotPoolGraph</a></span><span class="op">(</span><span class="va">modelObject</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>Now we can run the model, for wich we need to initialize the starting
values</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>My_mes<span class="op">=</span><span class="fl">1</span>, Mo_mes<span class="op">=</span><span class="fl">10</span>,My_mic<span class="op">=</span><span class="fl">0.6</span>, Mo_mic<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">times</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>,by<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p>We can then run the model with the specific <code>SoilR</code>
function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modrun0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SoilR/man/Model_by_PoolNames.html" class="external-link">Model_by_PoolNames</a></span><span class="op">(</span>smod<span class="op">=</span><span class="va">modelObject</span>, times<span class="op">=</span><span class="va">times</span>, initialValues<span class="op">=</span><span class="va">init</span><span class="op">)</span></span></code></pre></div>
<p>And, again relying on the specific <code>SoilR</code> function, we
can extract the C stocks and respiration fluxes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Stocks</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SoilR/man/getC.html" class="external-link">getC</a></span><span class="op">(</span><span class="va">modrun0</span><span class="op">)</span></span>
<span><span class="va">Resp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/SoilR/man/getReleaseFlux.html" class="external-link">getReleaseFlux</a></span><span class="op">(</span><span class="va">modrun0</span><span class="op">)</span></span></code></pre></div>
<p>Letâ€™s see what object we created (by plotting just the first rows of
it):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1] [,2]         [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.8000000    0 -0.360000000 -6.300000</span></span>
<span><span class="co">#&gt; [2,] 0.7257902    0 -0.200615068 -4.817084</span></span>
<span><span class="co">#&gt; [3,] 0.6696608    0 -0.087480390 -3.684389</span></span>
<span><span class="co">#&gt; [4,] 0.6266788    0 -0.007528916 -2.819208</span></span>
<span><span class="co">#&gt; [5,] 0.5932938    0  0.048621137 -2.158377</span></span>
<span><span class="co">#&gt; [6,] 0.5669394    0  0.087728304 -1.653596</span></span></code></pre></div>
<p>Everything seems in order and we can proceed to plot:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">Stocks</span>, type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, xlab<span class="op">=</span><span class="st">" "</span>, ylab<span class="op">=</span><span class="st">"Pool contents"</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"My_mes"</span>, <span class="st">"Mo_mes"</span>, <span class="st">"My_mic"</span>, <span class="st">"Mo_mic"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">Resp</span>,  type<span class="op">=</span><span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"Time"</span>, ylab<span class="op">=</span><span class="st">"Respiration"</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/fig1-1.png" width="576"></p>
<p>It is also possible to calculate the evolution of soil bulk densities
and soil C concentration based on the simulated C stocks.<br>
The soil bulk density relies on the function <code>gamma_b</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/f_som.html">f_som</a></span><span class="op">(</span>My_mic<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>      Mo_mic<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>      My_mes<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">3</span><span class="op">]</span>,</span>
<span>      Mo_mes<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">4</span><span class="op">]</span>,</span>
<span>      Delta_z_min<span class="op">=</span><span class="fl">20</span>,</span>
<span>      phi_min<span class="op">=</span><span class="fl">0.35</span>,</span>
<span>      gamma_m<span class="op">=</span><span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.5051903 0.5144970 0.5212742 0.5262390 0.5298873 0.5325699 0.5345388</span></span>
<span><span class="co">#&gt;  [8] 0.5359782 0.5370233 0.5377745 0.5383069 0.5386765 0.5389256 0.5390857</span></span>
<span><span class="co">#&gt; [15] 0.5391810 0.5392292 0.5392441 0.5392357 0.5392117 0.5391777</span></span></code></pre></div>
<p>While the soil C concentration on the function
<code>f_som</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gamma_b.html">gamma_b</a></span><span class="op">(</span>My_mic<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>        Mo_mic<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>        My_mes<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">3</span><span class="op">]</span>,</span>
<span>        Mo_mes<span class="op">=</span><span class="va">Stocks</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">4</span><span class="op">]</span>,</span>
<span>        Delta_z_min<span class="op">=</span><span class="fl">20</span>,</span>
<span>        phi_min<span class="op">=</span><span class="fl">1</span>,</span>
<span>        gamma_o<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>        gamma_m<span class="op">=</span><span class="fl">1.1</span>,</span>
<span>        f_agg<span class="op">=</span><span class="fl">3</span>,</span>
<span>        phi_mac<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 0.1700971 0.1719277 0.1732436 0.1741985 0.1748954 0.1754052 0.1757780</span></span>
<span><span class="co">#&gt;  [8] 0.1760498 0.1762467 0.1763881 0.1764882 0.1765576 0.1766044 0.1766345</span></span>
<span><span class="co">#&gt; [15] 0.1766524 0.1766614 0.1766642 0.1766626 0.1766581 0.1766517</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-model-with-the-wrapper-more-comfortable-less-transparent">Running the model with the wrapper (more comfortable, less
transparent)<a class="anchor" aria-label="anchor" href="#running-the-model-with-the-wrapper-more-comfortable-less-transparent"></a>
</h2>
<p>All the above functions can be run with a wrapper,
<code>run_Porous</code>, that takes care of running the simulation and
calculating bulk density and C concentration:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/run_Porous.html">run_Porous</a></span><span class="op">(</span>ky<span class="op">=</span><span class="fl">0.8</span>, ko<span class="op">=</span><span class="fl">0.04</span>,</span>
<span>                     kmix<span class="op">=</span><span class="fl">0.02</span>,</span>
<span>                     e<span class="op">=</span><span class="fl">0.15</span>,</span>
<span>                     Im<span class="op">=</span><span class="fl">0.08</span>, Ir<span class="op">=</span><span class="fl">0.048</span>,</span>
<span>                     F_prot<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                     phi_mac<span class="op">=</span><span class="fl">0.04</span>,</span>
<span>                     clay<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                     Delta_z_min<span class="op">=</span><span class="fl">14.2</span>,</span>
<span>                     gamma_o<span class="op">=</span><span class="fl">1.2</span>,</span>
<span>                     gamma_m<span class="op">=</span><span class="fl">2.7</span>,</span>
<span>                     proportion<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                     phi_min<span class="op">=</span><span class="fl">0.35</span>,</span>
<span>                     f_text_mic<span class="op">=</span><span class="fl">0.5069</span>,</span>
<span>                     f_agg<span class="op">=</span><span class="fl">3</span>,</span>
<span>                     init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>My_mes<span class="op">=</span><span class="fl">0.132</span>, Mo_mes<span class="op">=</span><span class="fl">0.507</span>, My_mic<span class="op">=</span><span class="fl">0.284</span>, Mo_mic<span class="op">=</span><span class="fl">0.579</span><span class="op">)</span>,</span>
<span>                     sim_length<span class="op">=</span><span class="fl">20</span>,</span>
<span>                     sim_steps<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time My_mes.stocks Mo_mes.stocks My_mic.stocks Mo_mic.stocks My_mes.resp</span></span>
<span><span class="co">#&gt; 1  0.0    0.13200000     0.5070000     0.2840000     0.5790000  0.10560000</span></span>
<span><span class="co">#&gt; 2  0.1    0.12299153     0.5086716     0.2854283     0.5790569  0.09839323</span></span>
<span><span class="co">#&gt; 3  0.2    0.11480162     0.5102367     0.2868089     0.5791218  0.09184129</span></span>
<span><span class="co">#&gt; 4  0.3    0.10735329     0.5117052     0.2881459     0.5791940  0.08588263</span></span>
<span><span class="co">#&gt; 5  0.4    0.10058027     0.5130858     0.2894428     0.5792733  0.08046422</span></span>
<span><span class="co">#&gt; 6  0.5    0.09442165     0.5143863     0.2907027     0.5793591  0.07553732</span></span>
<span><span class="co">#&gt;   Mo_mes.resp My_mic.resp Mo_mic.resp  f_som_sim gamma_b_sim Delta_z_sim</span></span>
<span><span class="co">#&gt; 1           0 0.003040000 0.001440000 0.05684442    1.320691    20.00694</span></span>
<span><span class="co">#&gt; 2           0 0.003248734 0.001407707 0.05663550    1.321741    19.98663</span></span>
<span><span class="co">#&gt; 3           0 0.003440146 0.001377702 0.05645050    1.322672    19.96864</span></span>
<span><span class="co">#&gt; 4           0 0.003615853 0.001349777 0.05628720    1.323495    19.95277</span></span>
<span><span class="co">#&gt; 5           0 0.003777251 0.001323750 0.05614365    1.324219    19.93883</span></span>
<span><span class="co">#&gt; 6           0 0.003925621 0.001299455 0.05601807    1.324854    19.92663</span></span></code></pre></div>
<p>Results can be accessed as plotted as a data frame:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">range_stocks</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">results</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">My_mes.stocks</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="va">range_stocks</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"Years"</span>, ylab<span class="op">=</span><span class="st">"C stocks"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">Mo_mes.stocks</span>, ylim<span class="op">=</span><span class="va">range_stocks</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">My_mic.stocks</span>, ylim<span class="op">=</span><span class="va">range_stocks</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">Mo_mic.stocks</span>, ylim<span class="op">=</span><span class="va">range_stocks</span>, type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"My_mes"</span>, <span class="st">"Mo_mes"</span>, <span class="st">"My_mic"</span>, <span class="st">"Mo_mic"</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, bty<span class="op">=</span><span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/fig2-1.png" width="576"></p>
<p>The <code>run_Porous</code>: function, on top of the simulation of C
stocks from the main model function <code>porous</code>, gives also the
simulated evolution of bulk density, the C concentration and layer
thickness:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">gamma_b_sim</span>,  type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">6</span>, xlab<span class="op">=</span><span class="st">"Years"</span>, ylab<span class="op">=</span><span class="st">"Bulk density"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">f_som_sim</span>,  type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">7</span>, xlab<span class="op">=</span><span class="st">"Years"</span>, ylab<span class="op">=</span><span class="st">"C concentration"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">time</span>, <span class="va">results</span><span class="op">$</span><span class="va">Delta_z_sim</span>,  type<span class="op">=</span><span class="st">"l"</span>, col<span class="op">=</span><span class="fl">5</span>, xlab<span class="op">=</span><span class="st">"Years"</span>, ylab<span class="op">=</span><span class="st">"Delta Z (cm)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/fig3-1.png" width="576"></p>
<p>A diagnostic function to check the mass balance of the model (sed for
development) is also available:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mass_balance.html">mass_balance</a></span><span class="op">(</span><span class="va">results</span>,   Im<span class="op">=</span><span class="fl">0.08</span>, Ir<span class="op">=</span><span class="fl">0.048</span>,  sim_length<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`C balance soil`</span></span>
<span><span class="co">#&gt; [1] 7.953207</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`C balance inputs`</span></span>
<span><span class="co">#&gt; [1] 12.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`mass balance`</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lorenzo Menichetti.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
